{"version":3,"file":"AutoComplete.js","names":["AutoComplete","originVal","button","document","createElement","classList","add","innerHTML","$element","appendChild","querySelector","addEventListener","remove","e","div","parentElement","childCount","childElementCount","throttle","keyUpHandler","bind","keyDownHandler","target","contains","value","dataset","val","func","delay","lastFunc","lastRan","args","context","call","Date","now","clearTimeout","setTimeout","key","console","log","selectedEl","nextElementSibling","previousElementSibling","lastElementChild","code","blur","fetch","then","response","json","datas","template","fragment","DocumentFragment","map","data","replace","join","content","Component","querySelectorAll","forEach","el"],"sources":["../ui-component/autoComplete/AutoComplete.js"],"sourcesContent":["import Component from \"../../basic/Component.js\";\r\n\r\nexport default class AutoComplete extends Component {\r\n    setElements() {\r\n        this.originVal = null;\r\n        const button = document.createElement(\"button\");\r\n        button.classList.add('directly');\r\n        button.innerHTML = '직접입력';\r\n        this.$element.appendChild(button);\r\n    }\r\n\r\n    setEvents() {\r\n        this.$element.querySelector('input').addEventListener('focus', () => {\r\n            this.$element.querySelector('.disabled')?.classList.remove('disabled');\r\n            this.$element.querySelector('.selected')?.classList.remove('selected');\r\n        })\r\n\r\n        this.$element.querySelector('.add-item')?.addEventListener('click', (e) => {\r\n            const div = document.createElement('div');\r\n            div.classList.add('auto-completes');\r\n            div.innerHTML = `\r\n                <input type=\"text\" name=\"\" id=\"\" class=\"search-input\">\r\n                <div class=\"auto-complete-group\"></div>\r\n                <button type=\"button\" class=\"add-item\">추가</button>\r\n                <button type=\"button\" class=\"remove-item\">삭제</button>\r\n            `\r\n            this.$element.parentElement.appendChild(div);\r\n            new AutoComplete(div);\r\n        })\r\n\r\n        this.$element.querySelector('.remove-item')?.addEventListener('click', (e) => {\r\n            const childCount = this.$element.parentElement.childElementCount;\r\n            (childCount > 1) && (this.$element.remove());\r\n        })\r\n\r\n        this.$element.addEventListener('keyup', this.throttle(this.keyUpHandler.bind(this), 100));\r\n\r\n        this.$element.addEventListener('keydown', this.throttle(this.keyDownHandler.bind(this), 300));\r\n\r\n        this.$element.addEventListener('click', ({ target }) => {\r\n            if(target.classList.contains('directly')) {\r\n                this.$element.querySelector('.auto-complete-group').classList.add('disabled');\r\n            }\r\n\r\n            if(target.classList.contains('auto-complete')) {\r\n                this.$element.querySelector('input').value = target.dataset.val;\r\n                this.$element.querySelector('.auto-complete-group').classList.add('disabled');\r\n            }\r\n        })\r\n    }\r\n\r\n    throttle(func, delay) {\r\n        let lastFunc;\r\n        let lastRan;\r\n        return function(...args) {\r\n            const context = this;\r\n            if(!lastRan) {\r\n                func.call(context, ...args);\r\n                lastRan = Date.now();\r\n            } else {\r\n                if (lastRan) clearTimeout(lastFunc);\r\n                lastFunc = setTimeout(function() {\r\n                    if((Date.now() - lastRan) >= delay) {\r\n                        func.call(context, ...args);\r\n                        lastRan = Date.now();\r\n                    }\r\n                }, delay - (Date.now() - lastRan));\r\n            }\r\n        }\r\n    }\r\n\r\n    keyUpHandler(e) {\r\n        if(e.key === 'Process') {\r\n            return;\r\n        }\r\n        if(e.key === 'ArrowDown') {\r\n            console.log('keyup', this.originVal, e)\r\n\r\n            let selectedEl = this.$element.querySelector('.auto-complete.selected');\r\n            if(selectedEl) {\r\n                selectedEl.classList.remove('selected');\r\n                selectedEl = selectedEl.nextElementSibling;\r\n                selectedEl?.classList.add('selected');\r\n            } else {\r\n                selectedEl = this.$element.querySelector('.auto-complete');\r\n                selectedEl.classList.add('selected');\r\n            }\r\n            this.$element.querySelector('input').value = selectedEl ? this.$element.querySelector('.auto-complete.selected')?.dataset.val : this.originVal;\r\n            return;\r\n        }\r\n\r\n        if(e.key === 'ArrowUp') {\r\n            let selectedEl = this.$element.querySelector('.auto-complete.selected');\r\n            if(selectedEl) {\r\n                selectedEl?.classList.remove('selected');\r\n                selectedEl = selectedEl.previousElementSibling;\r\n                selectedEl?.classList.add('selected');\r\n            } else {\r\n                selectedEl = this.$element.querySelector('.auto-complete-group').lastElementChild;\r\n                selectedEl.classList.add('selected');\r\n            }\r\n            this.$element.querySelector('input').value = selectedEl ? this.$element.querySelector('.auto-complete.selected')?.dataset.val : this.originVal;\r\n            return;\r\n        }\r\n    }\r\n\r\n    keyDownHandler(e) {\r\n        if(this.$element.querySelector('.auto-complete-group').classList.contains('disabled')) {\r\n            return;\r\n        }\r\n\r\n        if(e.code === 'ArrowDown' || e.code === 'ArrowUp') {\r\n            return;\r\n        }\r\n\r\n        if(e.key === 'Enter') {\r\n            if(!this.$element.querySelector('.auto-complete.selected')) {\r\n                return;\r\n            }\r\n            this.$element.querySelector('input').value = e.target.value;\r\n            this.$element.querySelector('.auto-complete-group').classList.add('disabled');\r\n            this.$element.querySelector('input').blur();\r\n            return;\r\n        }\r\n        console.log('keydown', e);\r\n\r\n        fetch(\"http://localhost:3000/autoComplete\")\r\n            .then(response => response.json())\r\n            .then(datas => {\r\n                console.log('fetch')\r\n                this.$element.querySelector('.auto-complete-group').innerHTML = '';\r\n                this.originVal = this.$element.querySelector('input').value;\r\n\r\n                const template = document.createElement('template');\r\n                const fragment = new DocumentFragment();\r\n                template.innerHTML = datas.map(data => `\r\n                        <div class=\"auto-complete\" data-val=\"${data}\">${data.replace(this.originVal, `<b>${this.originVal}</b>`)}</div> \r\n                    `).join(\"\");\r\n                fragment.appendChild(template.content);\r\n\r\n                this.$element.querySelector('.auto-complete-group').appendChild(fragment);\r\n            })\r\n    }\r\n}\r\n\r\ndocument.querySelectorAll('.auto-completes').forEach(el => new AutoComplete(el));"],"mappings":"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"}