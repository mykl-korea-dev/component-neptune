<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
<!--    <link rel="stylesheet" href="../../../basic/common.css">-->
<!--    <link rel="stylesheet" href="../../../dist/mykl_ui_style.css">-->
    <style>
    </style>
</head>
<body>
  <div>
      <div class="chart-wrap" style="width: 400px; height: 400px">
          <canvas id="myChart"></canvas>
      </div>
      <div class="tabs">
          <div>
              <p>공통역량</p>
              <ul>
                  <li class=""><a class="tab-item active" href="#basement">기반</a></li>
                  <li class=""><a class="tab-item" href="#job">직업공통역량</a></li>
                  <li class=""><a class="tab-item" href="#leadership">리더십역량</a></li>
                  <li class=""><a class="tab-item" href="#duty">직무공통역량</a></li>
              </ul>
          </div>
          <div class="tabs tab-list" id="basement">
              <p>기반역량</p>
              <ul>
                  <li><a class="tab-item active" href="#personality">인성</a></li>
                  <li><a class="tab-item" href="#edu">기초학력</a></li>
                  <li><a class="tab-item" href="">자기관리</a></li>
                  <li><a class="tab-item" href="#info">정보</a></li>
              </ul>
              <div class="tab-list" id="personality">
                  <p>인성</p>
                  <ul>
                      <li>윤리의식</li>
                      <li>공동체의식</li>
                  </ul>
              </div>
              <div class="tab-list" id="edu">
                  <p>기초학력</p>
                  <ul>
                      <li><a class="" href="">기초학력1</a></li>
                      <li><a class="" href="">기초학력2</a></li>
                  </ul>
              </div>
          </div>
          <div class="tabs tab-list" id="job">
              <p>직업</p>
              <ul>
                  <li><a class="tab-item active" href="#job1">직업1</a></li>
                  <li><a class="tab-item" href="#job2">직업2</a></li>
                  <li><a class="tab-item" href="">직업3</a></li>
                  <li><a class="tab-item" href="">직업4</a></li>
              </ul>
              <div class="tab-list" id="job1">
                  <p>job1</p>
                  <ul>
                      <li>job1-1</li>
                      <li>job1-2</li>
                  </ul>
              </div>
              <div class="tab-list" id="job2">
                  <p>job2</p>
                  <ul>
                      <li>job2-1</li>
                      <li>job2-2</li>
                  </ul>
              </div>
          </div>
          <div class="tabs tab-list" id="leadership">
              <p>리더십</p>
              <ul>
                  <li><a class="tab-item active" href="#leadership1">직업1</a></li>
                  <li><a class="tab-item" href="#leadership2">직업2</a></li>
                  <li><a class="tab-item" href="">직업3</a></li>
                  <li><a class="tab-item" href="">직업4</a></li>
              </ul>
              <div class="tab-list" id="leadership1">
                  <p>leadership1</p>
                  <ul>
                      <li>leadership1-1</li>
                      <li>leadership1-2</li>
                  </ul>
              </div>
              <div class="tab-list" id="leadership2">
                  <p>leadership2</p>
                  <ul>
                      <li>leadership2-1</li>
                      <li>leadership2-2</li>
                  </ul>
              </div>
          </div>
      </div>


  </div>
<!--  <script src="../../../dist/mykl_ui.js"></script>-->
  <script>
      // Mykl.Tab();
      // document.querySelectorAll('.tabs').forEach(el => MYKL.Tab(el));
      const canvas = document.querySelector('#myChart');
      const ctx = canvas.getContext('2d');

      const config = {
          type: 'pie',
          data: {
              labels: ['Total', 'Done'],
              datasets: [{
                  label: 'Done Counter',
                  backgroundColor: [
                      'rgba(255, 99, 132, 0.2)',
                      'rgba(54, 162, 235, 0.2)',
                  ],
                  borderColor: [
                      'rgba(255, 99, 132, 1)',
                      'rgba(54, 162, 235, 1)',
                  ],
                  data: [30, 20],
                  borderWidth: 1,
                  datalabels: {
                      anchor: 'center',
                      backgroundColor: null,
                      borderWidth: 0
                  }
              }],
          },
          plugins: [ChartDataLabels],
          options: {
              plugins: {
                  datalabels: {
                      formatter: function(value, context) {
                          return  value + '개';
                      },
                      font: {
                          size: '20'
                      },
                      anchor: 'end'
                  }
              },
          }
      }
      const myChart = new Chart(ctx, config);

  </script>
  <script>
      class Init {
          constructor() {
              this.initData = {};
              const url = "https://6f07b93d-8541-4869-91c1-b98e18900991.mock.pstmn.io/ability/duty";
              const regex = "https://6f07b93d-8541-4869-91c1-b98e18900991.mock.pstmn.io";
              const splitUrl = url.split(regex);

              splitUrl[0] = regex;
              splitUrl[1] = "/api" + splitUrl[1] + "/exts";
              this.initUrl = splitUrl[1];
              this.getInitData();
              // this.getInitObj(this.initUrl);
          }

          async getInitObj(url) {
              const regex = "https://6f07b93d-8541-4869-91c1-b98e18900991.mock.pstmn.io";
              const fetchUrl = regex + url;

              const res = await fetch(fetchUrl);
              const data = await res.json();
              console.log('url::::::', url);
              for (const item in data) {
                  // console.log(key)
                  if(/^[ext_]/gm.test(item)) {
                      const getKey = this.changeUnderBarToUrl(data[item]);
                      // console.log(item, getKey)
                      this.initData[getKey] = await this.getInitObj(data[item]);
                      // console.log(this.initData)
                  } else {
                      return data;
                  }
              }

          }

          changeUnderBarToUrl(url) {
              const splitUrl = url.split("/").join("_");
              const resultUrl = /^_/gm.test(splitUrl) ? splitUrl.slice(1) : splitUrl;
              return resultUrl;
          }

          async getInitData() {
              await this.getInitObj(this.initUrl);
              console.log(this.initData);
              return this.initData;
          }
      }
      // const newItem = new Init();
      // newItem.getInitData().then(data => console.log(data));
      (async () => {
          const initPage = await new Init().getInitData();
          console.log(initPage);
          // return initPage;
      })();
      // const initPage = async function () {
      //     // await new Init();
      // };
      // const a = initPage();
      // console.log(a.initData)

  </script>
</body>
</html>